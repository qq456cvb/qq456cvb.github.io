---
layout: compress
permalink: /projects/donut
---

<html lang="en">
  <head>
    <meta charset="UTF-8">

    <meta name="description" content="Project website for Make a Donut">
    <meta name="author" content="Yang You">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="/projects/donut/icons/donut_icon.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Make a Donut</title>
  </head>

  <style>
    .grad_text {
      background: -webkit-linear-gradient(right, #bc5090, #ff6361, #ffa600);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
  </style>

  <body>
    <section>
      <div class="relative items-center w-full px-5 pt-12 pb-2 mx-auto md:px-12 lg:px-16 max-w-7xl lg:pt-24 lg:pb-4">
        <div class="flex w-full mx-auto text-left">
          <div class="relative inline-flex items-center mx-auto align-middle">
            <div class="text-center">
              <h1 class="max-w-5xl text-3xl font-bold leading-none tracking-tighter text-black-600 md:text-5xl lg:text-5xl lg:max-w-7xl">
                <span class="grad_text">Make a Donut</span> &#127849;
              </h1>
              <h1 class="max-w-5xl text-3xl font-bold leading-none text-black-600 md:text-5xl lg:text-5xl lg:max-w-8xl pt-5" style="font-size:26pt">
            		Language-Guided Hierarchical EMD-Space Planning for Zero-Shot Deformable Object Manipulation
        	  </h1>
              <div class="space-y-2">
                <p class="max-w-6xl mx-auto mt-8 text-md md:text-xl lg:text-xl lg:text-xl leading-relaxed text-gray-600 space-x-5">
                  <a href="https://qq456cvb.github.io/" class="hover:text-gray-800">Yang You<sup>1</sup></a>
                  <a href="https://cs.stanford.edu/people/bshen88/" class="hover:text-gray-800">Bokui Shen<sup>1</sup></a>
                  <a href="https://cs.stanford.edu/~congyue/" class="hover:text-gray-800">Congyue Deng<sup>1</sup></a>
                  <a href="https://geng-haoran.github.io/" class="hover:text-gray-800">Haoran Geng<sup>2</sup></a>
                  <a href="https://github.com/songlin/" class="hover:text-gray-800">Songlin Wei<sup>2</sup></a>
                  <a href="https://hughw19.github.io/" class="hover:text-gray-800">He Wang<sup>2</sup></a>
                  <a href="https://geometry.stanford.edu/member/guibas/" class="hover:text-gray-800">Leonidas Guibas<sup>1</sup></a>
                </p>
                <p class="max-w-6xl mx-auto mt-8 text-md md:text-xl lg:text-xl lg:text-xl leading-relaxed text-gray-400 space-x-7">
                  <span><sup>1</sup>Stanford University</span>
                  <span><sup>2</sup>Peking University</span>
                </p>
              </div>
              <div class="flex items-center justify-center w-full max-w-2xl gap-2 mx-auto mt-6">
                <a href="https://arxiv.org/pdf/2311.02787.pdf" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-4 py-3 mr-2 mb-2 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
                  <svg aria-hidden="true" class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                  </svg>
                  <span>Paper</span>
                </a>
                <a href="https://arxiv.org/abs/2311.02787" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-4 py-3 mr-2 mb-2 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
                  <svg aria-hidden="true" class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M20.25 7.5l-.625 10.632a2.25 2.25 0 01-2.247 2.118H6.622a2.25 2.25 0 01-2.247-2.118L3.75 7.5M10 11.25h4M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125z" />
                  </svg>
                  <span>Arxiv</span>
                </a>
                <!-- <a href="" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-4 py-3 mr-2 mb-2 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
                  <svg aria-hidden="true" class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /><path stroke-linecap="round" stroke-linejoin="round" d="M15.91 11.672a.375.375 0 010 .656l-5.603 3.113a.375.375 0 01-.557-.328V8.887c0-.286.307-.466.557-.327l5.603 3.112z" />
                  </svg>
                  <span>Video (To appear)</span>
                </a> -->
                <a href="#" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-4 py-3 mr-2 mb-2 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
                  <svg aria-hidden="true" class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M14.25 9.75L16.5 12l-2.25 2.25m-4.5 0L7.5 12l2.25-2.25M6 20.25h12A2.25 2.25 0 0020.25 18V6A2.25 2.25 0 0018 3.75H6A2.25 2.25 0 003.75 6v12A2.25 2.25 0 006 20.25z" />
                  </svg>
                  <span>Code (Coming Soon)</span>
                </a>
              </div>
            </div>
          </div>
        </div>
        <div class="flex flex-col items-center justify-center pt-3 mx-auto rounded-lg lg:px-10 max-w-4xl">
          <div class="flex flex-col items-center justify-center py-6 mx-auto w-full">
            <img src="/projects/donut/images/teaser_website_cropped.gif" class="object-cover object-center" style="width:100%">
          </div>
        </div>
      </div>
      <div class="flex flex-col items-center px-5 pt-8 pb-6 my-6 mx-auto max-w-5xl sm:px-6 lg:px-8">
        <div class="flex flex-col w-full max-w-5xl mx-auto border-l-4 p-12 rounded-r-xl bg-gray-50 prose text-left text-gray-800 leading-7">
          <h2 class="text-2xl font-bold pb-5"><span>Abstract</span></h2>
          <p>
			Deformable object manipulation stands as one of the most captivating yet formidable challenges in robotics. While previous techniques have predominantly relied on learning latent dynamics through demonstrations, typically represented as either particles or images, there exists a pertinent limitation: acquiring suitable demonstrations, especially for long-horizon tasks, can be elusive. Moreover, basing learning entirely on demonstrations can hamper the model’s ability to generalize beyond the demonstrated tasks. In this work, we introduce a demonstration-free hierarchical planning approach capable of tackling intricate long-horizon tasks without necessitating any training. We employ large language models (LLMs) to articulate a high-level, stage-by-stage plan corresponding to a
			specified task. For every individual stage, the LLM provides both the tool’s name and the Python code to craft intermediate subgoal point clouds. With the tool and subgoal for a particular stage at our disposal, we present a granular closedloop model predictive control strategy. This leverages Differentiable Physics with Point-to-Point correspondence (DiffPhysics-P2P) loss in the earth mover distance (EMD) space, applied iteratively. Experimental findings affirm that our technique surpasses multiple benchmarks in dough manipulation, spanning both short and long horizons. Remarkably, our model demonstrates robust generalization capabilities to novel and previously unencountered complex tasks without any preliminary demonstrations. We further substantiate our approach with experimental trials on real-world robotic platforms.
          </p>
        </div>
      </div>
      <div class="flex flex-col items-center px-5 pt-9 pb-3 mx-auto max-w-6xl sm:px-6 lg:px-8">
        <div class="flex flex-col w-full max-w-6xl mx-auto prose text-left text-gray-800">
          <h2 class="text-2xl font-bold pb-5"><span class="grad_text">Method Overview</span></h2>
          <div>
            <p>
              <strong>Our method adopts a hierarchical planning approach combining both language models and low-level particle space controls.</strong>
              <strong>At the top level,</strong> LLMs are employed to break down a complex task into substages, and output both the code to generate subgoal states and the tool name for each.
              <strong>At the bottom level</strong>, given the current tool and subgoal, our technique iteratively identifies the next reachable target based on the present state and subgoal with a planning algorithm in the EMD space. 
            </p>
            <div class="flex flex-col items-center justify-center py-6 mx-auto lg:px-10">
              <img src="/projects/donut/images/pipeline2.png" class="object-cover object-center">
            </div>
          </div>
        </div>
      </div>
      <div class="flex flex-col items-center px-5 pt-6 pb-3 mx-auto max-w-6xl sm:px-6 lg:px-8">
        <div class="flex flex-col w-full max-w-6xl mx-auto prose text-left text-gray-800">
          <h2 class="text-2xl font-bold pb-5"><span class="grad_text">Two-Level Planning</span></h2>
          <div>
	        <p class="font-bold pb-2">Top level: LLM-guided multi-tool selection</p>
	        <p>
	          To guide this process, we devised a prompt template that imparts to the LLM foundational information about available tools and their potential interactions with the dough. We ask the LLM to output the following items for each stage during planning:
	        </p>
	        <p>
	          Additionally, we introduce two guidelines: <strong>volumn preserving</strong> and <strong>chain of reasoning</strong>, which improves the feasibility and stability of the generated targets.
	        </p>
	        <div class="flex flex-col items-center justify-center py-6 mx-auto w-full">
              <img src="/projects/donut/images/tab_guidelines.png" class="object-cover object-center" style="width:60%">
            </div>
	        <p>
	          To try the prompts yourself:
	        </p>
	        <ul>
	          <li>
	            First of all, copy this template prompt into GPT-4:
	            <a href="/projects/donut/prompts/template.txt" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-2 py-1 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
	              <span>Template prompt</span>
	            </a>
	    	  </li>
	          <li>
	            Next, append your customized prompt specifying the <strong>goal</strong> as well as the <strong>initial dough state</strong>. Prompts for the examples in the paper are:
	            <a href="/projects/donut/prompts/exp_donut.txt" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-2 py-1 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
	              <span>Donut</span>
	            </a>
	            <a href="/projects/donut/prompts/exp_baguette.txt" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-2 py-1 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
	              <span>Baguette</span>
	            </a>
	            <a href="/projects/donut/prompts/exp_pancakes.txt" class="inline-flex items-center text-white bg-gray-700 hover:bg-gray-800 focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-2 py-1 dark:bg-gray-600 dark:hover:bg-gray-700 focus:outline-none dark:focus:ring-gray-800">
	              <span>Pancakes</span>
	            </a>
	    	  </li>
	    	</ul>
	    	<br>
	        <p class="font-bold pb-2">Bottom level: single-tool EMD-space planning</p>
	        <p>
	        	We find the next reachable target by running small steps within the EMD space. The induced point-to-point correspondence can provide better gradients when optimizing actions through differential physics.
	        </p>
	        <div class="flex flex-col items-center justify-center py-6 mx-auto lg:px-10 max-w-3xl">
	          <img src="/projects/donut/images/singletool_pipeline.png" class="object-cover object-center">
	        </div>
	      </div>
        </div>
      </div>
      <div class="flex flex-col items-center px-5 pt-6 pb-3 mx-auto max-w-6xl sm:px-6 lg:px-8">
        <div class="flex flex-col w-full max-w-6xl mx-auto prose text-left text-gray-800">
            <h2 class="text-2xl font-bold pb-5"><span class="grad_text">Results</span></h2>
            <p class="font-bold pb-2">Simulated Experiments</p>
            <div class="relative items-center w-full px-4 pt-1 pb-1 mx-auto max-w-6xl">
              <p>"Make a Donut"</p>
              <div class="grid w-9/12 grid-cols-1 gap-10 mx-auto md:grid-cols-4 md:w-9/12">
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt1-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt1-0-2.gif" />
                </div>
                <div class="p-2">
            	  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt2-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt2-0-2.gif" />
                </div>
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt3-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt3-0-2.gif" />
                </div>
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt4-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/donut-prompt4-0-2.gif" />
                </div>
              </div>
            </div>
            <div class="relative items-center w-full px-4 pt-1 pb-1 mx-auto max-w-6xl">
              <p>"Make a Baguette"</p>
              <div class="grid w-9/12 grid-cols-1 gap-10 mx-auto md:grid-cols-4 md:w-9/12">
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt1-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt1-0-2.gif" />
                </div>
                <div class="p-2">
            	  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt2-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt2-0-2.gif" />
                </div>
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt3-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt3-0-2.gif" />
                </div>
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt4-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/baguette-prompt4-0-2.gif" />
                </div>
              </div>
            </div>
            <div class="relative items-center w-full px-4 pt-1 pb-1 mx-auto max-w-6xl">
              <p>"Make two Pancakes"</p>
              <div class="grid w-9/12 grid-cols-1 gap-10 mx-auto md:grid-cols-4 md:w-9/12">
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt1-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt1-0-2.gif" />
                  <p>Stage 3</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt1-0-3.gif" />
                </div>
                <div class="p-2">
            	  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt2-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt2-0-2.gif" />
                  <p>Stage 3</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt2-0-3.gif" />
                </div>
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt3-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt3-0-2.gif" />
                  <p>Stage 3</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt3-0-3.gif" />
                </div>
                <div class="p-2">
                  <p>Stage 1</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt4-0-1.gif" />
                  <p>Stage 2</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt4-0-2.gif" />
                  <p>Stage 3</p>
                  <img class="object-cover object-center w-full rounded-md" src="/projects/donut/images/results/twopancake-prompt4-0-3.gif" />
                </div>
              </div>
            </div>
            <br>
            <p class="font-bold pb-2">Real-Robot Experiments</p>
            <div class="flex flex-col items-center justify-center pt-3 mx-auto rounded-lg lg:px-10 max-w-4xl">
              <video height="auto" width="80%" autoplay loop muted>
                <source src="/projects/donut/video/visualized_goal_compressed.mp4" type="video/mp4">
              </video>
            </div>
        </div>
      </div>
      <div class="flex flex-col items-center px-5 pt-0 pb-12 mx-auto max-w-6xl sm:px-6 lg:px-8">
        <div class="flex flex-col w-full max-w-6xl mx-auto prose text-left text-gray-800">
          <h2 class="text-2xl font-bold pb-5"><span class="grad_text">BibTeX</span></h2>
          <pre><code class="language-plaintext text-sm sm:text-base inline-flex text-left items-center space-x-4 bg-gray-800 text-white rounded-lg p-4 pl-6">@article{you2023make,
  title={Make a Donut: Language-Guided Hierarchical EMD-Space Planning for Zero-shot Deformable Object Manipulation},
  author={You, Yang and Shen, Bokui and Deng, Congyue and Geng, Haoran and Wang, He and Guibas, Leonidas},
  journal={arXiv preprint arXiv:2311.02787},
  year={2023}
}</code></pre>
        </div>
      </div>
    </section>
    <footer class="bg-white mt-4" aria-labelledby="footer-heading">
      <h2 id="footer-heading" class="sr-only">Footer</h2>
      <div class="px-4 py-8 mx-auto bg-gray-50 w-full sm:px-6 lg:px-16">
        <div class="flex flex-wrap items-baseline lg:justify-center">
          <span class="text-sm text-center font-light text-gray-600">
            If you have any questions, please contact Yang You (yangyou@stanford.edu).
            <br/>
            Toyota Research Institute provided funds to support this work.
          </span>
        </div>
      </div>
    </footer>
  </body>
</html>
